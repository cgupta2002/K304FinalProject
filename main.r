install.packages(c("data.table", "dplyr", "curl", "ggplot2", "ggrepel", "ggthemes", "testthat", "readr", "viridis"))

library(data.table)
library(dplyr)
library(ggplot2)
library(ggrepel)
library(ggthemes)
library(testthat)
library(readr)
library(viridis)

#importing data into the program, data obtained from baseball-reference.com
TeamStats <- read_csv("Year,Age,G,PA,AB,R,H,2B,3B,HR,RBI,SB,CS,BB,SO,BA,OBP,SLG,OPS,OPS+,TB,GDP,HBP,SH,SF,IBB
2021,28.2,162,6084,5357,796,1373,275,22,190,757,57,20,586,1389,.256,.336,.422,.758,108,2262,139,78,24,39,10
2020,27.7,60,2267,2047,306,534,94,6,96,294,20,8,179,571,.261,.326,.453,.779,112,928,44,24,1,13,1
2019,27.7,161,6042,5529,708,1443,260,20,182,676,63,28,378,1549,.261,.314,.414,.728,93,2289,114,66,36,32,13
2018,26.5,162,6071,5523,656,1332,259,40,182,639,98,41,425,1594,.241,.302,.401,.703,93,2217,99,66,24,32,18
2017,26.8,162,6059,5513,706,1412,256,37,186,670,71,31,401,1397,.256,.314,.417,.731,96,2300,124,76,35,33,17
2016,28.4,162,6131,5550,686,1428,277,33,168,656,77,36,455,1285,.257,.317,.410,.727,99,2275,122,53,29,44,16
2015,28.2,162,6070,5533,622,1381,260,27,136,595,68,42,404,1231,.250,.306,.380,.686,92,2103,125,65,30,37,22
2014,27.8,162,6077,5543,660,1400,279,32,155,625,85,36,417,1362,.253,.310,.398,.708,102,2208,127,60,19,38,33
2013,29.4,162,6077,5563,598,1385,237,19,148,574,105,42,411,1207,.249,.302,.378,.680,84,2104,124,34,19,48,23
2012,30.1,162,6111,5518,748,1409,228,29,211,726,109,43,461,1203,.255,.318,.422,.740,98,2328,112,65,31,36,24")

#importing different data into the program, data obtained from baseball-reference.com
Top3Batters <- read_csv("Year,Rk,Pos,Name,Age,G,PA,AB,R,H,2B,3B,HR,RBI,SB,CS,BB,SO,BA,OBP,SLG,OPS,OPS+,TB,GDP,HBP,SH,SF,IBB
2021,1,C,Yasmani Grandal,32,93,375,279,60,67,9,0,23,62,0,0,87,82,.240,.420,.520,.939,158,145,15,3,1,5,0
2021,2,1B,Jose Abreu,34,152,659,566,86,148,30,2,30,117,1,0,61,143,.261,.351,.481,.831,126,272,28,22,0,10,3
2021,3,SS,Tim Anderson,28,123,551,527,94,163,29,2,17,61,18,7,22,119,.309,.338,.469,.806,119,247,5,1,0,1,1
2020,1,1B,Jose Abreu,33,60,262,240,43,76,15,0,19,60,0,0,18,59,.317,.370,.617,.987,165,148,10,3,0,1,1
2020,2,SS,Tim Anderson,27,49,221,208,45,67,11,1,10,21,5,2,10,50,.322,.357,.529,.886,140,110,4,2,0,1,0
2020,3,LF,Eloy Jimenez,23,55,226,213,26,63,14,0,14,41,0,0,12,56,.296,.332,.559,.891,139,119,4,0,0,1,0
2019,1,3B,Yoan Moncada,24,132,559,511,83,161,34,5,25,79,10,3,40,154,.315,.367,.548,.915,140,280,1,4,1,3,2
2019,2,SS,Tim Anderson,26,123,518,498,81,167,32,0,18,56,17,5,15,109,.335,.357,.508,.865,128,253,12,3,0,2,0
2019,3,1B,Jose Abreu,32,159,693,634,85,180,38,1,33,123,2,2,36,152,.284,.330,.503,.834,118,319,24,13,0,10,4
2018,1,1B,Jose Abreu,31,128,553,499,68,132,36,1,22,78,2,0,37,109,.265,.325,.473,.798,117,236,14,11,0,6,7
2018,2,OF,Daniel Palka,26,124,449,417,56,100,15,3,27,67,2,1,30,153,.240,.294,.484,.778,110,202,7,2,0,0,3
2018,3,DH,Matt Davidson,27,123,496,434,51,99,23,0,20,62,0,0,52,165,.228,.319,.419,.738,102,182,8,7,0,3,0
2017,1,1B,Jose Abreu,30,156,675,621,95,189,43,6,33,102,3,0,35,119,.304,.354,.552,.906,141,343,21,15,0,4,6
2017,2,RF,Avisail Garcia,26,136,561,518,75,171,27,5,18,80,5,3,33,111,.330,.380,.506,.885,138,262,14,9,0,1,5
2017,3,LF,Melky Cabrera,32,98,428,397,54,117,17,0,13,56,0,0,25,52,.295,.336,.436,.771,107,173,7,1,2,3,1
2016,1,1B,Jose Abreu,29,159,695,624,67,183,32,1,25,100,0,2,47,125,.293,.353,.468,.820,124,292,21,15,0,9,7
2016,2,LF,Melky Cabrera,31,151,646,591,70,175,42,5,14,86,2,0,47,69,.296,.345,.455,.800,118,269,17,0,3,5,2
2016,3,RF,Adam Eaton,27,157,706,619,91,176,29,9,14,59,14,5,63,115,.284,.362,.428,.790,117,265,6,14,7,3,2
2015,1,1B,Jose Abreu,28,154,668,613,88,178,34,3,30,101,0,0,39,140,.290,.347,.502,.850,135,308,16,15,0,1,11
2015,2,CF,Adam Eaton,26,153,689,610,98,175,28,9,14,56,18,8,58,131,.287,.361,.431,.792,122,263,5,14,5,2,2
2015,3,LF,Melky Cabrera,30,158,683,629,70,172,36,2,12,77,3,0,40,88,.273,.314,.394,.709,98,248,18,2,2,10,2
2014,1,1B,Jose Abreu,27,145,622,556,80,176,35,2,36,107,3,1,51,131,.317,.383,.581,.964,173,323,14,11,0,4,15
2014,2,DH,Adam Dunn,34,106,435,363,43,80,17,0,20,54,1,1,65,132,.220,.340,.433,.773,121,157,5,3,0,4,5
2014,3,CF,Adam Eaton,25,123,538,486,76,146,26,10,1,35,15,9,43,83,.300,.362,.401,.763,120,195,4,5,2,2,0
2013,1,DH,Adam Dunn,33,149,607,525,60,115,15,0,34,86,1,1,76,189,.219,.320,.442,.762,105,232,2,3,0,3,7
2013,2,RF,Alex Rios,32,109,465,430,57,119,22,2,12,55,26,6,32,78,.277,.328,.421,.749,102,181,12,1,0,1,2
2013,3,LF,Dayan Viciedo,24,124,473,441,43,117,23,3,14,56,0,0,24,98,.265,.304,.426,.731,97,188,11,3,0,5,0
2012,1,1B,Paul Konerko,36,144,598,533,66,159,22,0,26,75,0,0,56,83,.298,.371,.486,.857,130,259,16,7,0,2,4
2012,2,RF,Alex Rios,31,157,640,605,93,184,37,8,25,91,23,6,26,92,.304,.334,.516,.850,126,312,18,4,0,5,3
2021,3,C,A.J. Pierzynski,35,135,520,479,68,133,18,4,27,77,0,0,28,78,.278,.326,.501,.827,120,240,8,8,1,4,5")

BattingAvg <- TeamStats %>% 
  summarize(Year, BA, SO, G) %>% 
  mutate(SOPG = SO / G)

ggplot(BattingAvg, aes(x = Year, y = BA, fill = SOPG)) + 
  theme_fivethirtyeight() + 
  ggtitle("White Sox Team Batting Average Over Time") + 
  labs(fill = "Strike Outs Per Game") + 
  geom_col()

PerGameHitting <- TeamStats %>% 
  mutate(HPG = H/G, RBIPG = RBI/G) %>% 
  summarize(Year, RBIPG, HPG)

ggplot(PerGameHitting, aes(x = Year, y = RBIPG)) + 
  theme_fivethirtyeight() + 
  ggtitle("Chicago White Sox RBI Per Game Over Time") + 
  ylab("RBI Per Game") + 
  geom_line()

Top3Appearances <- Top3Batters %>% 
  group_by(Name) %>% 
  mutate(NumAppearances = n()) %>% 
  summarize(Name, NumAppearances) %>% 
  unique()
  
ggplot(Top3Appearances, aes(x = Name, y = NumAppearances)) +
  scale_x_discrete(guide = guide_axis(angle = 90)) +
  theme_fivethirtyeight() +
  ylab("Times Top 3") +
  geom_col()

Top3Positions <- Top3Batters %>% 
  group_by(Pos) %>% 
  mutate(NumPlayers = n()) %>% 
  summarize(Pos, NumPlayers) %>% 
  unique()

ggplot(Top3Positions, aes(x = Pos, y = NumPlayers)) +
  theme_fivethirtyeight() +
  labs(y = "Number of Players", x = "Position", title = "Top 3 White Sox Positions by OPS+ 2012-2021") +
  geom_col()





